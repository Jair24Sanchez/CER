<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporta eventos - CER</title>
    <link rel="stylesheet" href="./report-events.css">
</head>
<body>
    <!-- Modal CREATE -->
    <div id="createModal" class="modal-create">
        <div class="modal-create-content">
            <img src="./cer_blanco.png" alt="CER Logo" class="modal-create-logo">
            <div class="modal-create-title"><em>CREATE</em></div>
            <a href="./report-events.html" class="modal-create-btn">Reports</a>
            <a href="./organize.html" class="modal-create-btn">Organize</a>
        </div>
    </div>

    <!-- Modal LOGIN -->
    <div id="loginModal" class="modal-create" style="display:none;">
        <div class="modal-create-content modal-login-content">
            <img src="./cer_blanco.png" alt="CER Logo" class="modal-create-logo modal-login-logo">
            <div class="modal-create-title modal-login-title">LOGIN</div>
            <input id="loginEmail" type="email" placeholder="Email" class="login-input">
            <input id="loginPassword" type="password" placeholder="Password" class="login-input">
            <button id="loginSubmit" class="login-submit-btn">Entrar</button>
            <div class="register-link-container">
                <a href="#" id="registerLink" class="register-link">Si no te has registrado haz click aquí</a>
            </div>
            <div class="login-divider">o</div>
            <button id="googleLoginBtn" class="google-login-btn">Continuar con Google</button>
            <div class="login-divider">o conecta una wallet</div>
            <div class="wallet-grid">
                <button id="metamaskBtn" class="wallet-btn">MetaMask</button>
                <button id="coinbaseBtn" class="wallet-btn">Coinbase Wallet</button>
                <button id="rabbyBtn" class="wallet-btn">Rabby</button>
                <button id="walletConnectBtn" class="wallet-btn">WalletConnect</button>
            </div>
        </div>
    </div>

    <header class="main-header">
        <a href="./Homepage.html" class="logo-link">
            <img src="./cer-logo.png" alt="CER Logo" class="logo">
        </a>
        <div class="header-buttons">
            <button class="create-btn">CREATE</button>
            <button class="login-btn">LOGIN</button>
        </div>
    </header>

    <div class="title-bar">
        <img src="./report-events.jpg" alt="Reporta eventos" class="report-title-img" width="918" height="72" onerror="this.style.display='none';document.getElementById('imgError').style.display='block'">
        <div id="imgError" style="display:none;color:#c00;font-weight:bold;text-align:center;">No se encontró la imagen report-events.jpg</div>
    </div>

    <div class="filters-container">
        <select id="eventType" class="filter-select">
            <option value="irl">IRL Events</option>
            <option value="digital">Digital Events</option>
        </select>
        <select id="secondaryFilter" class="filter-select">
            <option value="">Subtipo</option>
        </select>
        <select id="statusFilter" class="filter-select">
            <option value="">Status</option>
            <option value="disponible">Disponible</option>
            <option value="espera">Espera</option>
            <option value="comienza">Comienza</option>
            <option value="edicion">Edición</option>
            <option value="declinado">Declinado</option>
            <option value="publicado">Publicado</option>
        </select>
        <select id="orderFilter" class="filter-select">
            <option value="relevancia">Relevancia</option>
            <option value="mayor-recompensa">Mayor recompensa a Voluntario</option>
            <option value="menor-recompensa">Voluntario a Mayor recompensa</option>
        </select>
    </div>

    <main>
        <div class="requests-grid" id="requestsGrid">
            <div class="own-report-card" id="ownReportBtn">
                <div class="own-report-line"></div>
                <div class="own-report-plus">+</div>
            </div>
            <!-- Aquí van los contenedores de solicitudes de reportes -->
        </div>

        <footer class="footer" style="margin-top:40px;">
            <div class="footer-left">
                <p>Events reported forever</p>
                <h2 id="totalEvents">0</h2>
                <p>Read</p>
            </div>
        </footer>
    </main>

    <script src="./js/countries-list.js"></script>
    <script src="./js/languages-list.js"></script>
    <script src="./js/report-events.js"></script>
    <script>
    // Actualizar contador como en Homepage
    (function(){
        const reportajes = JSON.parse(localStorage.getItem('reportajes') || '[]');
        const totalEl = document.getElementById('totalEvents');
        if (totalEl) totalEl.textContent = reportajes.length.toLocaleString();
    })();
    </script>
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
    <script src="../config/networks.js"></script>
    <script src="./js/config.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script src="./js/web3-contract.js"></script>
    <script src="./js/email-register.js"></script>
    <script src="./js/auth.js"></script>
    <script src="./js/modal-create.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="./js/login.js"></script>
    <script>
    document.getElementById('ownReportBtn').addEventListener('click', function() {
        // Verificar autenticación antes de redirigir
        if (window.auth && !window.auth.isAuthenticated()) {
            const loginModal = document.getElementById('loginModal');
            if (loginModal) {
                loginModal.style.display = 'flex';
                loginModal.classList.add('show');
            } else {
                alert('Debes iniciar sesión para crear un reportaje por iniciativa propia.');
            }
            return;
        }
        window.location.href = 'reporte-por-iniciativa-propia.html';
    });
    </script>
</body>
</html> 